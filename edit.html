<!DOCTYPE html> 
<html>
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fight Against Drugs</title>
    
    
    <link rel="stylesheet" href="css/jquery.mobile-1.4.5.css" />
    <!-- Google Web Font -->
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/drugs.css" />
    
    <script src="js/jquery-1.11.1.min.js"></script>
    <script src="js/jquery.mobile-1.4.5.min.js"></script>
    <!-- Custom JS -->
    <script src="js/function.js"></script>

    <!-- Jquery form validation -->
	<script src="js/jquery.validate.min.js"></script>
    
    </head> 
<body> 
<div data-role="page" id="edit">
	<div class="header">
        <a role="button" href="javascript:void(0);" class="ui-btn ui-corner-all ui-shadow ui-btn-left ui-toolbar-back-btn ui-icon-carat-l ui-btn-icon-left" data-rel="back">Back</a>
		<h1>Edit Message</h1>
	</div>
    
	<div data-role="content" style="min-height:40em;">	
    
    	<h2>Update Message</h2>
		<form name="updateform" id="updateform" enctype="multipart/form-data">
        
            <h4 class="formitem"><span class="required">*</span> Username <label for="username" generated="true" class="error nomargin"></label></h4>
            <input type="text" id="username" name="username" required />
            <h4 class="formitem"><span class="required">*</span> Email <label for="email" generated="true" class="error nomargin"></label></h4>
            <input type="email" id="email" name="email" required />
            <h4 class="formitem"><span class="required">*</span> New Subject <label for="newsubject" generated="true" class="error nomargin"></label></h4>
            <input type="text" id="newsubject" name="newsubject" required />
            <h4 class="formitem"><span class="required">*</span> New Message <label for="newmessage" generated="true" class="error nomargin"></label></h4>
            <textarea type="text" id="newmessage" rows="4" name="newmessage" required /></textarea>
            
            <button id="update" class="btn submit" type="submit" value="Update Message">Update Message</button>
        </form>

    
    	<hr />
        
    	<h2>Delete Message</h2>
        
		<form name="delform" id="delform" enctype="multipart/form-data">
            <h4 class="formitem"><span class="required">*</span> Username <label for="deluser" generated="true" class="error nomargin"></label></h4>
            <input type="text" id="deluser" name="deluser" required />
            <h4 class="formitem"><span class="required">*</span> Email <label for="delemail" generated="true" class="error nomargin"></label></h4>
            <input type="email" id="delemail" name="delemail" required />
            
            <button id="delete" class="btn del" type="submit" value="Delete Message">Delete Message</button>
        </form>

        <div class="footer">
            <h4>&copy; Fight Against Drugs</h4>
        </div>
    </div>
</div>

<script>
$(document).ready(function() {
	
	
	//==============Update Message===============
	$("#update").on('click',function() {
		var username=$("#username").val();
		var email=$("#email").val();
		var newsubject=$("#newsubject").val();
		var newmessage=$("#newmessage").val();

		var myData = 'username='+username+'&email='+email+'&newsubject='+newsubject+'&newmessage='+newmessage;
		
		
		$("#updateform").validate({
			submitHandler : function () {
				// if validate success
				$.ajax({
					url:'msg-edit',
					type:"PUT",
					dataType : 'text',
					data:myData,
					success : function (data) {
						
						window.location = "message-board";
						alert("Your Message has been Updated");
					},
					error:function(xhr, ajaxOptions, thrownError){
						alert(xhr.status);
						alert(thrownError);
					}
				});
				
			}
		});

	});
	
	
	
	//==============Delete review===============
	$("#delete").on('click',function() {

		var username=$("#deluser").val();
		var email=$("#delemail").val();
		
		var myData = 'username='+username+'&email='+email;
		
		
		$("#delform").validate({
			submitHandler : function () {
				// if validate success
				$.ajax({
					url:'msg-edit',
					type:"DELETE",
					dataType : 'text',
					data:myData,
					success : function (data) {
						
						window.location = "message-board";
						alert("Your Message has been Deleted");
					},
					error:function(xhr, ajaxOptions, thrownError){
						alert(xhr.status);
						alert(thrownError);
					}
				});
				
			}
		});
	
	});
	
	

});
</script>

</body>
</html>
